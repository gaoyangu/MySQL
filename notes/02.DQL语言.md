## 5. DQL语言
Data Query Language

查询: select

### 5.1 基础查询

语法：`select 查询列表 from 表名;`
1. 查询列表可以是：表中的字段、常量、表达式、函数
2. 查询的结果是一个虚拟的表格

**1. 查询表中的字段**
```sql
use myemployees;

#查询表中的单个字段
select last_name from employees;

#查询表中的多个字段
select last_name, salary, email from employees;

#查询表中的所有字段
select * from employees;

select `name` from employees;
```

**2. 查询常量值**
```sql
select 100;
select 'john';
```

**3. 查询表达式**
```sql
select 100*98;
select 100%98;
```

**4. 查询函数**
```sql
select VERSION();
```

**5. 起别名**
- 便于理解
- 如果查询的字段有重名的情况，使用别名可以区分开
```sql
#方式一
select 100*98 as result;
select last_name as lastName, first_name as firstName from employees;

#方式二
select last_name lastName, first_name firstName from employees;
select salary as 'out put' from employees;
```

**6. 去重 distinct**
```sql
select department_id from employees;
select distinct department_id from employees;
```

**7. +号的作用，concat()**
- mysql中的+号只有一个功能：运算符

```sql
#两个操作数都为数值型，则做加法运算
select 100+90;

#只要一方为字符型，试图将字符型数值转换成数值型
#如果转换成功，则继续做加法运算
#如果转换失败，则将字符型数值转换为0
select '123'+90;
select 'john'+90;

#只要其中一方为null，结果肯定为null
select null+10;

#查询员工名和姓连接成一个字段，并显示为姓名
select concat(last_name, first_name) as 'name' from employees;
```

**8. ifnull()**
```sql
select 
    concat(first_name,',',last_name,',', ifnull(commission_pct,0)) as out_put 
from 
    employees;
```

### 5.2 条件查询

语法：`select 查询列表 from 表名 where 筛选条件;`

执行顺序：from -> where -> select

分类：
1. 按条件表达式筛选
    - 条件运算符：>, <, =, <>, >=, <=
2. 按逻辑表达式筛选
    - 逻辑运算符: && || !
    - and or not
3. 模糊查询
    - like
    - between and 
    - in
    - is null

**1. 按条件表达式筛选**
```sql
#查询工资>12000的员工信息
select * from employees where salary > 12000;

#查询部门编号不等于90号的员工名和部门编号
select last_name, department_id from employees where department_id<>90;
```

**2. 按逻辑表达式筛选**
```sql
#查询工资在10000到20000之间的员工名、工资以及奖金
select last_name, salary, commission_pct from employees where salary>=10000 and salary<=20000;

#部门编号不是在90到110之间，或者工资高于15000的员工信息
select * from employees where department_id<90 or department_id>110 or salary>15000;
select * from employees where not(department_id>=90 and department_id<=110) or salary>15000;
```

**3. 模糊查询**

like
- 一般和通配符搭配使用
    - % 任意多个字符，包含零个字符
    - _ 任意单个字符

```sql
#查询员工名中包含a的员工信息
select * from empolyees where last_name like '%a%';

#查询员工名中第三个字符为e，第五个字符为a的员工名和工资
select last_name, salary from employees where last_name like '__n_l%';

#查询员工名中第二个字符为_的员工名
select last_name from employess where last_name like '_\_%';
#推荐
select last_name from employess where last_name like '_$_%' escape '$';
```

between and
- 提高语句简洁度
- 包含临界值
- 两个临界值不要调换顺序

```sql
#查询员工编号在100到120之间的员工信息
select * from employees where employee_id between 100 and 120;
```

in
- 判断某字段的值是否属于in列表中的一项
- 提高语句简洁度
- in列表的值类型必须一致或兼容
- 不支持通配符
```sql
#查询员工的工种编号是 IT_PROG、AD_VP、AD_PRES中的一个员工名和工种编号
select last_name, job_id from emplyees where job_id in('IT_PROG', 'AD_VP', 'AD_PRES');
```

is null
- = 或 <> 不能用于判断null值
- is null 或 is not null 可以
```sql
#查询没有奖金的员工名和奖金率
select last_name, commission_pct from employees where commission_pct is null;
#查询有奖金的员工名和奖金率
select last_name, commission_pct from employees where commission_pct is not null;
```

安全等于 <=>
- 可读性较差
```sql
#查询没有奖金的员工名和奖金率
select last_name, commission_pct from employees where commission_pct <=> null;

#查询工资为12000的员工信息
select last_name, commission_pct from employees where salary <=> 12000;
```
